{"version":3,"file":"ProjectTable.vue_vue_type_script_setup_true_lang.691b3265.1715140736669.js","sources":["../../src/pages/table/ProjectTable.vue"],"sourcesContent":["<script lang=\"ts\" setup>\n  import { reactive, ref } from 'vue';\n  import {\n    PlusOutlined,\n    EditFilled,\n    UploadOutlined,\n    SaveOutlined,\n  } from '@ant-design/icons-vue';\n  import EditableCell from '@/components/editable-cell';\n  import { message } from 'ant-design-vue';\n  import { getBase64 } from '@/utils/file';\n\n  const columns = [\n    { title: 'COMPANIES', dataIndex: 'company' },\n    {\n      title: 'BUDGET',\n      dataIndex: 'budget',\n      customRender: ({ text }: any) => `$${text}`,\n    },\n    { title: 'STATUS', dataIndex: 'status' },\n    { title: 'COMPLETION', dataIndex: 'progress' },\n    { title: 'OPERATION', dataIndex: 'operation', width: 200, align: 'center' },\n  ];\n\n  type Project = {\n    logo?: string;\n    company?: string;\n    budget?: number;\n    status?: number;\n    progress?: number;\n    _edit?: boolean;\n  };\n\n  const projects = reactive<Array<Project>>([\n    {\n      logo: '/src/assets/logo/shopify.svg',\n      company: 'shopify',\n      budget: 1200,\n      status: 1,\n      progress: 90,\n    },\n    {\n      logo: '/src/assets/logo/atlassian.svg',\n      company: 'atlassian',\n      budget: 1200,\n      status: 1,\n      progress: 90,\n    },\n    {\n      logo: '/src/assets/logo/invision.svg',\n      company: 'invision',\n      budget: 1200,\n      status: 1,\n      progress: 90,\n    },\n    {\n      logo: '/src/assets/logo/jira.svg',\n      company: 'jira',\n      budget: 1200,\n      status: 1,\n      progress: 90,\n    },\n  ]);\n\n  const mapStatus = (val: number) => {\n    switch (val) {\n      case -1:\n        return 'exception';\n      case 0:\n        return 'pause';\n      case 1:\n        return 'working';\n      default:\n        return 'unknown';\n    }\n  };\n\n  function saveRecord(record: any) {\n    record._edit = false;\n    message.success('修改成功');\n  }\n\n  function extractImg(file: Blob, record: any) {\n    getBase64(file).then((res) => {\n      record.logo = res;\n    });\n  }\n\n  /**\n   * 新增记录\n   */\n  function addNew() {\n    projects.push({ progress: 10, _edit: true });\n  }\n</script>\n<template>\n  <!-- 工程 -->\n  <a-table\n    :title=\"() => '工程表格'\"\n    v-bind=\"$attrs\"\n    :columns=\"columns\"\n    :dataSource=\"projects\"\n    :pagination=\"false\"\n    rowClassName=\"text-subtext\"\n  >\n    <template #bodyCell=\"{ column, text, record }\">\n      <div class=\"flex items-center\" v-if=\"column.dataIndex === 'company'\">\n        <EditableCell\n          :options=\"{\n            size: 'small',\n            format: 'YYYY-MM-DD HH:mm',\n            showTime: true,\n          }\"\n          :edit=\"record._edit\"\n          v-model:value=\"record.company\"\n        >\n          <template #input>\n            <a-upload\n              :show-upload-list=\"false\"\n              :beforeUpload=\"(file: File) => extractImg(file, record)\"\n            >\n              <img\n                class=\"h-8 rounded border border-dashed border-border p-0.5\"\n                v-if=\"record.logo\"\n                :src=\"record.logo\"\n              />\n              <a-button v-else :loading=\"false\" type=\"dashed\">\n                <template #icon>\n                  <UploadOutlined />\n                </template>\n              </a-button>\n            </a-upload>\n            <a-input class=\"ml-2\" v-model:value=\"record.company\" />\n          </template>\n          <img class=\"w-8 rounded\" :src=\"record.logo\" />\n          <span class=\"ml-2 text-title text-base\">{{ record.company }}</span>\n        </EditableCell>\n      </div>\n      <template v-else-if=\"column.dataIndex === 'budget'\">\n        <EditableCell\n          v-model:value=\"record.budget\"\n          :edit=\"record._edit\"\n          :options=\"{\n            prefix: '￥',\n          }\"\n        >\n          ￥{{ record.budget }}\n        </EditableCell>\n      </template>\n      <template v-else-if=\"column.dataIndex === 'status'\">\n        <EditableCell\n          :edit=\"record._edit\"\n          v-model:value=\"record.status\"\n          type=\"select\"\n          :options=\"{\n            options: [\n              { label: 'exception', value: -1 },\n              { label: 'pause', value: 0 },\n              { label: 'working', value: 1 },\n            ],\n            class: 'w-24',\n          }\"\n        >\n          <a-badge color=\"blue\">\n            <template #text>\n              <span>{{ mapStatus(record.status) }}</span>\n            </template>\n          </a-badge>\n        </EditableCell>\n      </template>\n      <template v-else-if=\"column.dataIndex === 'progress'\">\n        <EditableCell\n          :edit=\"record._edit\"\n          v-model:value=\"record.progress\"\n          type=\"slider\"\n          :options=\"{ tooltipVisible: true }\"\n        >\n          <a-progress\n            :strokeWidth=\"4\"\n            :percent=\"record.progress\"\n            status=\"exception\"\n          />\n        </EditableCell>\n      </template>\n      <template v-else-if=\"column.dataIndex === 'operation'\">\n        <a-button type=\"link\" v-if=\"!record._edit\" @click=\"record._edit = true\">\n          <template #icon>\n            <EditFilled />\n          </template>\n          编辑\n        </a-button>\n        <a-button type=\"link\" v-else @click=\"saveRecord(record)\">\n          <template #icon>\n            <SaveOutlined />\n          </template>\n          保存\n        </a-button>\n      </template>\n    </template>\n    <template #summary>\n      <a-table-summary>\n        <a-table-summary-row>\n          <a-table-summary-cell colspan=\"5\">\n            <a-button size=\"large\" class=\"w-full\" type=\"dashed\" @click=\"addNew\">\n              <PlusOutlined />\n              新增一列\n            </a-button>\n          </a-table-summary-cell>\n        </a-table-summary-row>\n      </a-table-summary>\n    </template>\n  </a-table>\n</template>\n"],"names":["columns","text","projects","reactive","mapStatus","val","saveRecord","record","message","extractImg","file","getBase64","res","addNew"],"mappings":"inBAYE,MAAAA,EAAA,CAAgB,CAAA,MAAA,YAAA,UAAA,SAAA,EAC6B,CAC3C,MAAA,SACS,UAAA,SACI,aAAA,CAAA,CAAA,KAAAC,CAAA,IAAA,IAAAA,GAC0B,EACvC,CAAA,MAAA,SAAA,UAAA,QAAA,EACuC,CAAA,MAAA,aAAA,UAAA,UAAA,EACM,CAAA,MAAA,YAAA,UAAA,YAAA,MAAA,IAAA,MAAA,QAAA,CAC6B,EAY5EC,EAAAC,EAAA,CAA0C,CACxC,KAAA,+BACQ,QAAA,UACG,OAAA,KACD,OAAA,EACA,SAAA,EACE,EACZ,CACA,KAAA,iCACQ,QAAA,YACG,OAAA,KACD,OAAA,EACA,SAAA,EACE,EACZ,CACA,KAAA,gCACQ,QAAA,WACG,OAAA,KACD,OAAA,EACA,SAAA,EACE,EACZ,CACA,KAAA,4BACQ,QAAA,OACG,OAAA,KACD,OAAA,EACA,SAAA,EACE,CACZ,CAAA,EAGFC,EAAAC,GAAA,CACE,OAAAA,EAAA,CAAa,IAAA,GAET,MAAA,YAAO,IAAA,GAEP,MAAA,QAAO,IAAA,GAEP,MAAA,UAAO,QAEP,MAAA,SAAO,CACX,EAGF,SAAAC,EAAAC,EAAA,CACEA,EAAA,MAAA,GACAC,EAAA,QAAA,MAAA,CAAsB,CAGxB,SAAAC,EAAAC,EAAAH,EAAA,CACEI,EAAAD,CAAA,EAAA,KAAAE,GAAA,CACEL,EAAA,KAAAK,CAAc,CAAA,CACf,CAMH,SAAAC,GAAA,CACEX,EAAA,KAAA,CAAA,SAAA,GAAA,MAAA,EAAA,CAAA,CAA2C"}